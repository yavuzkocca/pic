<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>WAGASA</title>

  <script sandbox="allow-scripts" type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>

  <script id="snippet-random-code" type="text/javascript">
    let seed = window.location.href.split("/").find((t) => t.includes("i0"));
    if (seed == null) {
      const alphabet = "0123456789abcdefghijklmnopqrstuvwsyz";
      seed =
        new URLSearchParams(window.location.search).get("seed") ||
        Array(64)
          .fill(0)
          .map((_) => alphabet[(Math.random() * alphabet.length) | 0])
          .join("") + "i0";
    } else {
      let pattern = "seed=";
      for (let i = 0; i < seed.length - pattern.length; ++i) {
        if (seed.substring(i, i + pattern.length) == pattern) {
          seed = seed.substring(i + pattern.length);
          break;
        }
      }
    }

    function cyrb128($) {
      let _ = 1779033703,
        u = 3144134277,
        i = 1013904242,
        l = 2773480762;
      for (let n = 0, r; n < $.length; n++)
        (_ = u ^ Math.imul(_ ^ (r = $.charCodeAt(n)), 597399067)),
          (u = i ^ Math.imul(u ^ r, 2869860233)),
          (i = l ^ Math.imul(i ^ r, 951274213)),
          (l = _ ^ Math.imul(l ^ r, 2716044179));
      return (
        (_ = Math.imul(i ^ (_ >>> 18), 597399067)),
        (u = Math.imul(l ^ (u >>> 22), 2869860233)),
        (i = Math.imul(_ ^ (i >>> 17), 951274213)),
        (l = Math.imul(u ^ (l >>> 19), 2716044179)),
        [(_ ^ u ^ i ^ l) >>> 0, (u ^ _) >>> 0, (i ^ _) >>> 0, (l ^ _) >>> 0]
      );
    }

    function sfc32($, _, u, i) {
      return function () {
        (u >>>= 0), (i >>>= 0);
        var l = (($ >>>= 0) + (_ >>>= 0)) | 0;
        return (
          ($ = _ ^ (_ >>> 9)),
          (_ = (u + (u << 3)) | 0),
          (u =
            ((u = (u << 21) | (u >>> 11)) +
              (l = (l + (i = (i + 1) | 0)) | 0)) |
            0),
          (l >>> 0) / 4294967296
        );
      };
    }
    let mathRand = sfc32(...cyrb128(seed));
  </script>
  <style>
    body {
      margin: 0px;
    }

    canvas {
      width: 100% !important;
      height: 100% !important;
      object-fit: contain;
      position: fixed;
      top: 0;
      left: 0;
    }
  </style>
</head>

<body>
  <script type="text/javascript">
    const rand = mathRand();

    function generateRandomNumber(minRange, maxRange) {
      return mathRand() * (maxRange - minRange) + minRange;
    }

    // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add your code here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓

    //const container = document.createElement("div");
    //container.innerHTML = "<span>seed: " + seed + "</span><br>";
    //document.body.prepend(container);

    new p5();

    let spheres = [];
    let palette;

    function pickNumber(numbers, weights) {
      let totalWeight = 0;
      for (let i = 0; i < weights.length; i++) {
        totalWeight += weights[i];
      }
      let randomNumber = generateRandomNumber(0, totalWeight);
      let weightSum = 0;

      for (let i = 0; i < numbers.length; i++) {
        weightSum += weights[i];
        if (randomNumber <= weightSum) {
          return { number: numbers[i], index: i };
        }
      }
    }

    let rotationSpeed = generateRandomNumber(0.01, 0.03);
    let n = floor(generateRandomNumber(1, 20)) * 10;
    let maxRadius = generateRandomNumber(1.5, 2.5);
    let off = generateRandomNumber(0, 1000);

    //WAGASA
    let segments;
    let segmentNumbers = [12, 24, 20, 30, 36];
    let weightss = [3, 5, 4, 2, 1];
    let segmentTraits = ["12", "24", "20", "30", "36"];
    let segmentResult = pickNumber(segmentNumbers, weightss);
    let segmentPickedNumber = segmentResult.number;
    let segmentPickedTrait = segmentTraits[segmentResult.index];

    //SPEED
    let speedNumbers = [0.01, 0.0125, 0.015, 0.0175, 0.02];
    let weightsSpeed = [3, 5, 4, 2, 1];
    let speedTraits = [
      "verySlow",
      "slowly",
      "notFast",
      "fast",
      "fastAndFurious",
    ];
    let speedResult = pickNumber(speedNumbers, weightsSpeed);
    let speedPickedNumber = speedResult.number;
    let speedPickedTrait = speedTraits[speedResult.index];
    let speed = speedPickedNumber;

    let paletteTrait = [
      "Radioactive Peacock",
      "Puddle of Puke",
      "Sweat Stain",
      "Faded Memories",
      "Deadly Migraine",
      "Moldy Shower Curtain",
      "Satan's Sunrise",
      "Post-Apocalyptic Rainbow",
    ];

    let colorPalletePicker;
    const weights = [0.2, 0.2, 0.1, 0.2, 0.1, 0.1, 0.05, 0.05];
    const randomNum = rand;
    let weightSum = 0;
    for (let i = 0; i < weights.length; i++) {
      weightSum += weights[i];
      if (randomNum <= weightSum) {
        colorPalletePicker = i;
        break;
      }
    }

    function setup() {
      switch (colorPalletePicker) {
        case 0:
          palette = [
            [1, 22, 39],
            [253, 255, 252],
            [46, 196, 182],
            [231, 29, 54],
            [255, 159, 28],
          ];
          break;
        case 1:
          palette = [
            [0, 18, 25],
            [0, 95, 115],
            [10, 147, 150],
            [148, 210, 189],
            [233, 216, 166],
            [238, 155, 0],
            [202, 103, 2],
            [187, 62, 3],
            [174, 32, 18],
            [155, 34, 38],
          ];
          break;
        case 2:
          palette = [
            [96, 108, 56],
            [40, 54, 24],
            [254, 250, 224],
            [221, 161, 94],
            [188, 108, 37],
          ];
          break;
        case 3:
          palette = [
            [230, 57, 70],
            [241, 250, 238],
            [168, 218, 220],
            [69, 123, 157],
            [29, 53, 87],
          ];
          break;
        case 4:
          palette = [
            [255, 190, 11],
            [251, 86, 7],
            [240, 20, 140],
            [131, 56, 236],
            [58, 134, 255],
          ];
          break;
        case 5:
          palette = [
            [218, 215, 205],
            [163, 177, 138],
            [88, 129, 87],
            [58, 90, 64],
            [52, 78, 65],
          ];
          break;
        case 6:
          palette = [
            [3, 7, 30],
            [55, 6, 23],
            [106, 4, 15],
            [157, 2, 8],
            [208, 0, 0],
            [220, 47, 2],
            [232, 93, 4],
            [244, 140, 6],
            [250, 163, 7],
            [255, 186, 8],
          ];
          break;
        case 7:
          palette = [
            [240, 20, 140],
            [255, 202, 58],
            [138, 201, 38],
            [25, 130, 196],
            [106, 76, 147],
          ];
          break;
      }

      createCanvas(windowHeight, windowHeight);
      background(0);
      noStroke();
      for (let i = 0; i < n; i++) {
        let x = generateRandomNumber(0, windowHeight);
        let y = generateRandomNumber(0, windowHeight);
        let r = (generateRandomNumber(20, 50) * windowHeight) / 600;

        let c = palette[floor(generateRandomNumber(0, palette.length))];
        spheres.push(new Sphere(x, y, r, c));
      }
    }

    function draw() {
      background(0, 50);
      for (let i = 0; i < spheres.length; i++) {
        spheres[i].update();
        spheres[i].display();
      }
    }

    class Sphere {
      constructor(x, y, r, c) {
        this.pos = createVector(x, y);
        this.radius = r;
        this.color = c;
        this.off = off;
        this.speed = speed;
        this.maxRadius = r * maxRadius;
        this.minRadius = r;
        this.direction = generateRandomNumber(-1, 1);
        this.rotation = 0;
        this.rotationSpeed = rotationSpeed;
      }
      update() {
        this.off += this.speed;
        this.radius = map(
          noise(this.off),
          0,
          1,
          this.minRadius,
          this.maxRadius
        );
        this.rotation += this.direction * this.rotationSpeed;
      }
      display() {
        push();
        translate(this.pos.x, this.pos.y);
        rotate(this.rotation);
        segments = segmentPickedNumber;
        let angle = TWO_PI / segments;
        beginShape(TRIANGLE_FAN);
        fill(this.color[0], this.color[1], this.color[2], 100);
        vertex(0, 0);
        for (let i = 0; i <= segments; i++) {
          let x = cos(i * angle) * this.radius;
          let y = sin(i * angle) * this.radius;
          let c = map(i, 0, segments, 0, 1);
          fill(
            lerpColor(
              color(this.color[0], this.color[1], this.color[2], 0),
              color(this.color[0], this.color[1], this.color[2], 255),
              c
            )
          );
          vertex(x, y);
        }
        endShape();
        pop();
      }
    }

    // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add your code here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑

    // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add traits here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    function Trait0(maxRadius) {
      if (maxRadius < 2) {
        return "short";
      } else {
        return "long";
      }
    }

    function Trait1(paletteTrait) {
      return paletteTrait;
    }

    function Trait2(off) {
      if (off < 333) {
        return "onSet";
      } else if (off < 666 && 334 < off) {
        return "maybeSet";
      } else {
        return "offSet";
      }
    }

    function Trait3(n) {
      if (n < 30) {
        return "Pleasantly Vacant";
      } else if (n < 75 && 29 < n) {
        return "Sparsely Sprinkled";
      } else if (n < 100 && 74 < n) {
        return "Moderately Amusing";
      } else if (n < 151 && 99 < n) {
        return "Densely Hilarious";
      } else if (n < 165 && 150 < n) {
        return "Uncomfortably Cozy";
      } else if (n < 175 && 164 < n) {
        return "Sassily Stifling";
      } else {
        return "Suffocatingly Stuffed";
      }
    }

    function Trait4(rotationSpeed) {
      if (rotationSpeed < 0.02) {
        return "forward";
      } else {
        return "onward";
      }
    }

    window.$generativeTraits = {
      position: Trait0(maxRadius),
      wenSet: Trait2(off),
      stuffMeter: Trait3(n),
      rotationSpeed: Trait4(rotationSpeed),
      palette: Trait1(paletteTrait[colorPalletePicker]),
      segment: segmentPickedTrait,
      speed: speedPickedTrait,
    };
    // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add traits here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑
  </script>
</body>

</html>